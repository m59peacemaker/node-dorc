const R = require('ramda');
const rmi = require('./');
const minimist = require('minimist');
const pickIfAnySpecified = require('../../lib/pick-if-any-specified');
const needsBuild = require('../../lib/service/needs-build');

// TODO: Prompt to verify images to be deleted! [Y/n]
const parse = (args, options) => {
  return { services: minimist(args)._ };
};

const handler = (services, config, args = {}) => {
  return R.pipe(pickIfAnySpecified(args.services), R.compose(_ => Promise.all(_), R.values, R.map(R.when(needsBuild, rmi))))(services);
};

module.exports = {
  usage: 'rmi <services...>',
  parse,
  handler
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9oYW5kbGVyL3JtaS9jbWQuanMiXSwibmFtZXMiOlsiUiIsInJlcXVpcmUiLCJybWkiLCJtaW5pbWlzdCIsInBpY2tJZkFueVNwZWNpZmllZCIsIm5lZWRzQnVpbGQiLCJwYXJzZSIsImFyZ3MiLCJvcHRpb25zIiwic2VydmljZXMiLCJfIiwiaGFuZGxlciIsImNvbmZpZyIsInBpcGUiLCJjb21wb3NlIiwiUHJvbWlzZSIsImFsbCIsInZhbHVlcyIsIm1hcCIsIndoZW4iLCJtb2R1bGUiLCJleHBvcnRzIiwidXNhZ2UiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLElBQUlDLFFBQVEsT0FBUixDQUFWO0FBQ0EsTUFBTUMsTUFBTUQsUUFBUSxJQUFSLENBQVo7QUFDQSxNQUFNRSxXQUFXRixRQUFRLFVBQVIsQ0FBakI7QUFDQSxNQUFNRyxxQkFBcUJILFFBQVEsaUNBQVIsQ0FBM0I7QUFDQSxNQUFNSSxhQUFhSixRQUFRLCtCQUFSLENBQW5COztBQUVBO0FBQ0EsTUFBTUssUUFBUSxDQUFDQyxJQUFELEVBQU9DLE9BQVAsS0FBbUI7QUFDL0IsU0FBTyxFQUFDQyxVQUFVTixTQUFTSSxJQUFULEVBQWVHLENBQTFCLEVBQVA7QUFDRCxDQUZEOztBQUlBLE1BQU1DLFVBQVUsQ0FBQ0YsUUFBRCxFQUFXRyxNQUFYLEVBQW1CTCxPQUFPLEVBQTFCLEtBQWlDO0FBQy9DLFNBQU9QLEVBQUVhLElBQUYsQ0FDTFQsbUJBQW1CRyxLQUFLRSxRQUF4QixDQURLLEVBRUxULEVBQUVjLE9BQUYsQ0FBVUosS0FBS0ssUUFBUUMsR0FBUixDQUFZTixDQUFaLENBQWYsRUFBK0JWLEVBQUVpQixNQUFqQyxFQUF5Q2pCLEVBQUVrQixHQUFGLENBQU1sQixFQUFFbUIsSUFBRixDQUFPZCxVQUFQLEVBQW1CSCxHQUFuQixDQUFOLENBQXpDLENBRkssRUFHTE8sUUFISyxDQUFQO0FBSUQsQ0FMRDs7QUFPQVcsT0FBT0MsT0FBUCxHQUFpQjtBQUNmQyxTQUFPLG1CQURRO0FBRWZoQixPQUZlO0FBR2ZLO0FBSGUsQ0FBakIiLCJmaWxlIjoiY21kLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUiA9IHJlcXVpcmUoJ3JhbWRhJylcbmNvbnN0IHJtaSA9IHJlcXVpcmUoJy4vJylcbmNvbnN0IG1pbmltaXN0ID0gcmVxdWlyZSgnbWluaW1pc3QnKVxuY29uc3QgcGlja0lmQW55U3BlY2lmaWVkID0gcmVxdWlyZSgnfi9saWIvcGljay1pZi1hbnktc3BlY2lmaWVkJylcbmNvbnN0IG5lZWRzQnVpbGQgPSByZXF1aXJlKCd+L2xpYi9zZXJ2aWNlL25lZWRzLWJ1aWxkJylcblxuLy8gVE9ETzogUHJvbXB0IHRvIHZlcmlmeSBpbWFnZXMgdG8gYmUgZGVsZXRlZCEgW1kvbl1cbmNvbnN0IHBhcnNlID0gKGFyZ3MsIG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtzZXJ2aWNlczogbWluaW1pc3QoYXJncykuX31cbn1cblxuY29uc3QgaGFuZGxlciA9IChzZXJ2aWNlcywgY29uZmlnLCBhcmdzID0ge30pID0+IHtcbiAgcmV0dXJuIFIucGlwZShcbiAgICBwaWNrSWZBbnlTcGVjaWZpZWQoYXJncy5zZXJ2aWNlcyksXG4gICAgUi5jb21wb3NlKF8gPT4gUHJvbWlzZS5hbGwoXyksIFIudmFsdWVzLCBSLm1hcChSLndoZW4obmVlZHNCdWlsZCwgcm1pKSkpXG4gICkoc2VydmljZXMpXG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICB1c2FnZTogJ3JtaSA8c2VydmljZXMuLi4+JyxcbiAgcGFyc2UsXG4gIGhhbmRsZXJcbn1cbiJdfQ==